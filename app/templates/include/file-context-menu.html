{% load home_tags %}

{% if request.user.is_authenticated and request.user == file.user %}
<div class="dropdown">
    <button class="btn btn-outline-secondary btn-sm file-context-dropdown" type="button" data-bs-toggle="dropdown" aria-expanded="false"><i class="fa-solid fa-ellipsis-vertical"></i></button>
    <ul class="dropdown-menu" id="file-{{ file.pk }}-dropdown">
        {% if '/u/' not in request.path %}
        <li>
            <a role="button" class="clip dropdown-item" data-clipboard-text="{{ request.scheme }}://{{ request.get_host }}{{ file.preview_uri }}">
                <i class="fa-solid fa-link fa-fw link-info"></i><span class="text-end">&nbsp;Copy Share Link</span></a>
        </li>
        <li>
            <a role="button" class="clip dropdown-item" data-clipboard-text="{{ request.scheme }}://{{ request.get_host }}{% url 'home:url-raw-redirect' file.file.name %}">
                <i class="fa-solid fa-link fa-fw link-warning"></i><span class="text-end">&nbsp;Copy Raw Link</span></a>
        </li>
        <li><hr class="dropdown-divider"></li>
        {% endif%}
        <li>
            <a role="button" class="set-expr-btn dropdown-item" data-pk="{{ file.pk }}" title="Set Expiration">
                <i class="fa-solid fa-hourglass fa-fw"></i><span class="text-end">&nbsp;Set Expiration</span></a>
        </li>
        <li>
            <a role="button" class="toggle-private-btn dropdown-item" data-pk="{{ file.pk }}" title="Toggle Private">
                {% if file.private %}
                    <i id="privateDropdownIcon" class="fa-solid fa-fw fa-lock-open "></i>&nbsp;<span id="privateText">Make Public</span>
                {% else %}
                    <i id="privateDropdownIcon" class="fa-solid fa-fw fa-lock"></i>&nbsp;<span id="privateText">Make Private</span>
                {% endif %}
            </a>
        </li>
        <li>
            <a role="button" class="set-password-file-btn dropdown-item" data-pk="{{ file.pk }}" title="Set Password">
                <i class="fas fa-key link-info fa-fw"></i>&nbsp;Set Password</a>
        </li>
        <li><hr class="dropdown-divider"></li>
        <li>
            <a role="button" class="delete-file-btn dropdown-item" data-pk="{{ file.pk }}" title="Delete">
                <i class="fa-regular fa-trash-can link-danger fa-fw"></i><span class="text-end">&nbsp;Delete File</span></a>
        </li>
    </ul>
</div>
{% endif %}